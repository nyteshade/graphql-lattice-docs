
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API GQL Lattice</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#attaching-to-express" class="toc-h1 toc-link" data-title="Attaching to Express">Attaching to Express</a>
          </li>
          <li>
            <a href="#creating-your-graphql-objects" class="toc-h1 toc-link" data-title="Creating your GraphQL Objects">Creating your GraphQL Objects</a>
          </li>
          <li>
            <a href="#gqlexpressmiddleware" class="toc-h1 toc-link" data-title="GQLExpressMiddleware">GQLExpressMiddleware</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-a-new-instance" class="toc-h2 toc-link" data-title="GQLExpressMiddleware">Create a new instance</a>
                  </li>
                  <li>
                    <a href="#obtain-the-middleware-used-with-express" class="toc-h2 toc-link" data-title="GQLExpressMiddleware">Obtain the middleware used with Express</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#gqlbase" class="toc-h1 toc-link" data-title="GQLBase">GQLBase</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#schemas" class="toc-h2 toc-link" data-title="GQLBase">Schemas</a>
                  </li>
                  <li>
                    <a href="#resolvers" class="toc-h2 toc-link" data-title="GQLBase">Resolvers</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='mailto:admin@graphql-lattice.com'>Contact Author</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the GraphQL Lattice API Docs!</p>

<p>GraphQL Lattice is designed to work with NodeJS and Express 4.x. Although it may be made to work in more places later if there is sufficient demand.</p>

<aside class="warning">Lattice is a work in progress and if you start to consume it now, you should be aware that it will likely change rapidly over the near future.</aside>
<h1 id='attaching-to-express'>Attaching to Express</h1>
<blockquote>
<p>When adding the endpoint, for now, you will need to import all the classes that extend <code>GQLBase</code> as well as <code>graphql-lattice</code> itself.</p>

<p>A typical express route file looks like this</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">Express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">)</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">GQLExpressMiddleware</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'graphql-lattice'</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">SampleGQLBaseObj</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./graph/SampleGQLBaseObj'</span><span class="p">)</span>

<span class="c1">// Create an Express object to add to your app via app.use()</span>
<span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">Express</span><span class="p">();</span>

<span class="c1">// Instantiate a new instance of GQLExpressMiddleware. Currently it takes</span>
<span class="c1">// the class objects you've defined that extend GQLBase. </span>
<span class="c1">// NOTE That it does not take an instancce of these classes but the class </span>
<span class="c1">// or function itself.</span>
<span class="kr">const</span> <span class="nx">lattice</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GQLExpressMiddleware</span><span class="p">([</span>
  <span class="nx">SampleGQLBaseObj</span>
<span class="p">]);</span>

<span class="c1">// Add the route using the simplest version</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">middleware</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>In the future a version or function on the middleware will allow you to simply specify a directory in your project&#39;s filesystem and any and all GQLBase extended exports will be read automatically once the server starts.</p>
</blockquote>

<p>You will likely be importing graphql-lattice in two types of places. The first will be wherever you are adding the express endpoint for graphql. The second place will be wherever you create your GraphQL objects.</p>
<h1 id='creating-your-graphql-objects'>Creating your GraphQL Objects</h1>
<blockquote>
<p>When writing a class that extends GQLBase, you can do so like the following</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="p">{</span> <span class="nx">GQLBase</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'graphql-lattice'</span><span class="p">);</span>

<span class="kr">class</span> <span class="nx">SampleGQLBaseObj</span> <span class="kr">extends</span> <span class="nx">GQLBase</span> <span class="p">{</span>
  <span class="c1">// Guts of the GQLBase extension class (see below)</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">SampleGQLBaseObj</span><span class="p">;</span>
</code></pre><h1 id='gqlexpressmiddleware'>GQLExpressMiddleware</h1><h2 id='create-a-new-instance'>Create a new instance</h2>
<blockquote>
<p>Create a new instance of GQLExpressMiddleware</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="p">{</span> <span class="nx">GQLExpressMiddleware</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'graphql-lattice'</span><span class="p">)</span>

<span class="c1">// Import/require all the GQLBase classes you've written</span>

<span class="kr">const</span> <span class="nx">lattice</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GQLExpressMiddleware</span><span class="p">([</span>
  <span class="c1">// Comma separate all the GQLBase'd classes that </span>
  <span class="c1">// make up your graph.</span>
<span class="p">]);</span>
</code></pre>
<p>A handler that exposes an express middleware function that mounts a GraphQL I/O endpoint. For now, takes an Array of classes extending from GQLBase. These are parsed and a combined schema of all their individual schemas is generated via the use of ASTs. This is passed off to express-graphql.</p>

<p>As mentioned above, this approach is temporary and will quickly become a less desirable option once the module parser is complete. It will, however, remain for legacy and one-off usages</p>
<h2 id='obtain-the-middleware-used-with-express'>Obtain the middleware used with Express</h2>
<blockquote>
<p>As of this writing, GQL Lattice supports a few different ways to obtain the Express compatible middleware.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// The most common</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">middleware</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Some folks will want a version that doesn&#39;t mount the GraphiQL explorer on POST</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// The second most common. </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">middleware</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">middlewareWithoutGraphiQL</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Alternatively, if there are specific <code>express-graphql</code> options you wish to submit, you can create a custom middleware</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// Rare</span>
<span class="c1">// See https://github.com/graphql/express-graphql#options for more detail</span>
<span class="kr">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* graphqlHTTP options */</span> <span class="p">}</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">customMiddleware</span><span class="p">(</span><span class="nx">opts</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Finally, if you need to programmatically do something specific with the options AFTER GraphQL Lattice is done with them, you can specify a function to do so</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// Almost never happens</span>
<span class="c1">// See https://github.com/graphql/express-graphql#options for more detail</span>
<span class="kr">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* graphqlHTTP options */</span> <span class="p">}</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/graphql'</span><span class="p">,</span> <span class="nx">lattice</span><span class="p">.</span><span class="nx">customMiddleware</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// do something to the completed opts object</span>
  <span class="c1">// THEN return it when you're done making changes</span>
  <span class="k">return</span> <span class="nx">opts</span><span class="p">;</span>
<span class="p">}));</span>
</code></pre><h3 id='middleware-getter'>middleware (getter)</h3>
<p>This is by far the most common. It is identical to calling <code>customMiddleware({graphiql: true})</code></p>
<h3 id='middlewarewithoutgraphiql-getter'>middlewareWithoutGraphiQL (getter)</h3>
<p>This is used for those that wish to mount their <code>GET</code> and <code>POST</code> endpoints separately and do not want to allow the GraphiQL browser on POST.</p>
<h3 id='custommiddleware'>customMiddleware</h3>
<p>If your needs require you to specify different values to graphqlHTTP, part of the express-graphql package, you can use the customMiddleware function to do so.</p>

<p>The first parameter is an object that should contain valid graphqlHTTP options. See <a href="https://github.com/graphql/express-graphql#options">https://github.com/graphql/express-graphql#options</a> for more details. Validation is NOT performed.</p>

<p>The second parameter is a function that will be called after any options have been applied from the first parameter and the rest of the middleware has been performed. This, if not modified, will be the final options passed into graphqlHTTP. In your callback, it is expected that the supplied object is to be modified and THEN RETURNED. Whatever is returned will be used or passed on. If nothing is returned, the options supplied to the function will be used instead.</p>
<h1 id='gqlbase'>GQLBase</h1>
<blockquote>
<p>All your base GraphQL object types should extend from GQLBase. It provides a lot of consistency and allows the type to be automatically added to the generated schema.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="p">{</span> <span class="nx">GQLBase</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'graphql-lattice'</span>
<span class="c1">// or</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">GQLBase</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'graphql-lattice'</span><span class="p">)</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">YourGQLType</span> <span class="kr">extends</span> <span class="nx">GQLBase</span> <span class="p">{</span>
  <span class="c1">// Class contents</span>
<span class="p">}</span>

<span class="c1">// Or alternatively you can use `module.exports = YourGQLType`</span>
</code></pre>
<p>The <code>GQLBase</code> class should be the root of your business logic&#39;s GraphQL Types if you wish them to be used with GraphQL Lattice. The base class offers us several small advantages that we can take advantage of.</p>

<ul>
<li>It has a built in mechanism, standardized, to store our data model after fetching from whichever data source it lives in.</li>
<li>It provides us a couple consistent ways to store and present our GraphQL schema for our objects</li>
<li>It provides us a way to either import or define our query resolvers and mutation resolvers specific to our type</li>
</ul>
<h3 id='schemas'>Schemas</h3>
<blockquote>
<p>Example showing a definition of a schema</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="p">{</span> <span class="nx">GQLBase</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'graphql-lattice'</span>

<span class="kr">export</span> <span class="kr">class</span> <span class="nx">Sample</span> <span class="kr">extends</span> <span class="nx">GQLBase</span> <span class="p">{</span> 
  <span class="kr">static</span> <span class="nx">get</span> <span class="nx">SCHEMA</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">return</span> <span class="s2">`
      type Sample { 
        id: ID! 
        name: String 
      }
    `</span> 
  <span class="p">}</span> 
<span class="p">}</span>
</code></pre>
<p>Every GraphQL object definition needs some associated GraphQL schema code. Lattice suggests the usage of the GraphQL SDL Schema Language to build your schema up.</p>
<h3 id='resolvers'>Resolvers</h3>
<blockquote>
<p>Handling basic query resolvers</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="p">{</span> <span class="nx">GQLBase</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'graphql-lattice'</span>

<span class="kr">export</span> <span class="kr">class</span> <span class="nx">Sample</span> <span class="kr">extends</span> <span class="nx">GQLBase</span> <span class="p">{</span>
  <span class="kr">static</span> <span class="nx">get</span> <span class="nx">SCHEMA</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`
      type Sample {
        id: ID!
        name: String 
      }

      type Query {
        exampleSample: Sample
      }
    `</span>
  <span class="p">}</span>

  <span class="kr">static</span> <span class="nx">async</span> <span class="nx">RESOLVERS</span><span class="p">({</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">gql</span><span class="p">})</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">exampleSample</span><span class="p">:</span> <span class="nx">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">model</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">GetOurExampleModelData</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Sample</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example using a getter/function/async function and differences between that and something returned in RESOLVERS()</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// a comment</span>
</code></pre>
<p>Typically when writing new GraphQL types using <code>GQLBase</code>, you will need to define a few things. One, you must define the schema for your type as well as any resolvers required for actions for your type. Resolvers are broken into two locations</p>

<ol>
<li>In the object returned by the static function <code>RESOLVERS()</code></li>
<li>As a <code>getter</code>, <code>function</code> or <code>async function</code> on the GraphQL type class itself.</li>
</ol>
<h1 id='errors'>Errors</h1>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
